##################
# Malware signature(adrd)
##################
# name=malware-dlog

.include "Z.dom"
.include "M.dom"
.include "H.dom"
.include "L.dom"
.include "S.dom"
.include "CL.dom"
.include "COMP.dom"

.bddvarorder COMP0_CL0_COMP1_CL1_COMP2_S0_L0_Z0_M0_COMP3_L1_H0

ICCG(s:COMP,t:COMP)  input
SpecCallerComp(m:M,c:COMP)  input  #special call, e.g, does component c invoke abortBroadcast?
FlowComp(comp1:COMP, src:CL, comp2:COMP, sink:CL) input
Receiver(r:COMP) input
Service(r:COMP) input
Activity(r:COMP) input
InstallAPK(r:COMP) input
TgtDataType(r:COMP,h:H) input
CompIntentAction(c:COMP,act:S) input
Priority(c:COMP,p:Z) input

abortBroadcast(m:M) input
RuntimeExec(m:M) input
sendTextMsg(m:M) input

BootCompleted(act:S) input
SmsReceived(act:S) input
PickWifi(act:S) input
UmsConnected(act:S) input
ConnectChg(act:S) input
BatteryLow(act:S) input
PhoneState(act:S) input
SmsSent(act:S) input
NewOutCall(act:S) input
SigStr(act:S) input
PkgAdd(act:S) input
PkgChg(act:S) input
PkgRemove(act:S) input
PkgReplace(act:S) input
PkgInstall(act:S) input

AppSrcSink(d:L) input
DeviceId(d:L) input
SubId(e:L) input
EncSrc(e:L) input
EncSink(e:L) input
Internet(e:L) input
MODEL(e:L) input
BRAND(e:L) input
SDK(e:L) input
Manufact(e:L) input
Product(e:L) input
LineNumber(e:L) input
SmsContent(e:L) input
SimSerial(e:L) input
FileSrc(e:L) input
FileSink(e:L) input
WebView(e:L) input
Exec(e:L) input
InstallPackage(e:L) input

LCL(l:L,cl:CL) input

###################
#   OUTPUT 
###################
ADRD(r:COMP,s:COMP,t:COMP)  output
AnserverBot(r:COMP) output
BaseBridge(r:COMP,s:COMP) output 
BeanBot(r:COMP,s:COMP,t:COMP,q:COMP) output
Bgserv(r:COMP,s:COMP) output
CoinPirate(r:COMP,s:COMP,t:COMP) output
DroidCoupon(r:COMP,s:COMP,t:COMP) output
DroidDream(r:COMP,s:COMP) output
DroidDreamLight(r:COMP,s:COMP) output
DroidKungFu1(r:COMP,s:COMP,a:COMP) output
DroidKungFu2(r:COMP,s:COMP,a:COMP) output
DroidKungFu3(r:COMP,s:COMP,a:COMP) output
DroidKungFu4(r:COMP,a:COMP) output
Geinimi(r:COMP,s:COMP) output
GingerMaster(r:COMP,s:COMP) output
GoldDream(r:COMP,s:COMP) output
PJapps(r:COMP,s:COMP) output
jSMSHider(r:COMP,a:COMP,s:COMP) output
EncNet(s:L, t:L) output
#NotDevNet(s:L, t:L) output
#For signature synthesis
SrcSinkComp(comp1:COMP, src:L, comp2:COMP, sink:L) output
BackEdge(s:COMP,t:COMP)  output
HasAPK(s:COMP) output

###################
#    RULES
###################
EncNet(src,sink) :- LCL(src,srccl), EncSrc(src), LCL(sink,sinkcl), Internet(sink), FlowComp(_,srccl,_,sinkcl).
NotEncNet(src,sink) :- !EncNet(src,sink).

SrcSinkComp(comp1,src,comp2,sink) :- FlowComp(comp1,srccl,comp2,sinkcl), LCL(src,srccl),AppSrcSink(src), LCL(sink,sinkcl), AppSrcSink(sink).
#t transitively launches s.
BackEdge(s,t) :- ICCG(t,s).
BackEdge(s,t) :- BackEdge(s,u), ICCG(t,u).
HasAPK(g) :- InstallAPK(g), ICCG(_,g).

#ADRD signature------
ADRD(r,s,t) :-   \
    Receiver(r), Receiver(s), Service(t), \
    ICCG(r,s), ICCG(s,t), ICCG(t,s), \
    CompIntentAction(r,act), \
    BootCompleted(act), \
    FlowComp(t,srccl1,t1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), EncSink(sink1), \
    FlowComp(t,srccl2,t1,sinkcl2), \
    LCL(src2,srccl2), SubId(src2), LCL(sink2,sinkcl2), EncSink(sink2), \
    FlowComp(t,srccl3,t1,sinkcl3), \
    LCL(src3,srccl3), EncSrc(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    t=t1.

#AnserverBot signature------
#/*
# action(r) = {BOOT_COMPLETED, SMS_RECEIVED, UMS_CONNECTED, PICK_WIFI_WORK}
# calls(s) = {'<android.content.BroadcastReceiver: void abortBroadcast()>'}
# flows(r) = {$getDeviceId->!INTERNET, $MODEL->!INTERNET,$MANUFACTURER->!INTERNET, $getSubscriberId->!INTERNET}
# */
AnserverBot(r) :-        \
    Receiver(r),           \
    Priority(r, _), \
    SpecCallerComp(m,r), abortBroadcast(m), \
    CompIntentAction(r,act1), \
    BootCompleted(act1), \
    CompIntentAction(r,act2), \
    SmsReceived(act2), \
    CompIntentAction(r,act3), \
    UmsConnected(act3), \
    CompIntentAction(r,act4), \
    PickWifi(act4), \
    FlowComp(r,srccl1,r1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(r,srccl2,r1,sinkcl2), \
    LCL(src2,srccl2), MODEL(src2), LCL(sink2,sinkcl2), Internet(sink2), \
    FlowComp(r,srccl3,r1,sinkcl3), \
    LCL(src3,srccl3), Manufact(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    FlowComp(r,srccl4,r1,sinkcl4), \
    LCL(src4,srccl4), SubId(src4), LCL(sink4,sinkcl4), Internet(sink4), \
    r=r1.

#BaseBridge signature------
#/*
# receiver(r)
# service(s)
# priority(r) > 1000
# action(r) = {BOOT_COMPLETED, SMS_RECEIVED, CONNECTIVITY_CHANGE, BATTERY_LOW}
# calls(r) = {'<android.content.BroadcastReceiver: void abortBroadcast()>'}
# flows(s) = {$content://sms->!INTERNET, $MODEL->!INTERNET,$PRODUCT->!INTERNET, $getSubscriberId->!INTERNET}
# launch(r,s)
#  */
BaseBridge(r,s) :-         \
    Receiver(r), Service(s), \
    ICCG(r,s), \
    Priority(r,_),  \
    SpecCallerComp(m,r), abortBroadcast(m), \
    CompIntentAction(r,act1), \
    BootCompleted(act1), \
    CompIntentAction(r,act2), \
    SmsReceived(act2), \
    CompIntentAction(r,act3), \
    ConnectChg(act3), \
    CompIntentAction(r,act4), \
    BatteryLow(act4), \
    FlowComp(s,srccl1,s1,sinkcl1), \
    LCL(src1,srccl1), SmsContent(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(s,srccl2,s1,sinkcl2), \
    LCL(src2,srccl2), MODEL(src2), LCL(sink2,sinkcl2), Internet(sink2), \
    FlowComp(s,srccl3,s1,sinkcl3), \
    LCL(src3,srccl3), Product(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    FlowComp(s,srccl4,s1,sinkcl4), \
    LCL(src4,srccl4), SubId(src4), LCL(sink4,sinkcl4), Internet(sink4), \
    s=s1.

#BeanBot signature------
#/*FIXME >
# receiver(r)
# service(s)
# service(t)
# service(q)
# priority(r) > 1000
# action(r) = {PHONE_STATE}
# calls(r) = {'<android.content.BroadcastReceiver: void abortBroadcast()>'}
# flows(s) = {$getLine1Number->!INTERNET, $getDeviceId->!INTERNET, $getSimSerialNumber->!INTERNET}
# launch(r,s)
# launch(s,t)
# launch(s,q)
# t != q
# */
BeanBot(r,s,t,q) :-                      \
    Receiver(r), Service(s), Service(t), Service(q), \
    ICCG(r,s), ICCG(s,t), ICCG(s,q), t!=q, \
    Priority(r,_), \
    SpecCallerComp(m,r), abortBroadcast(m), \
    CompIntentAction(r,act1), \
    PhoneState(act1), \
    FlowComp(s,srccl1,s1,sinkcl1), \
    LCL(src1,srccl1), LineNumber(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(s,srccl2,s1,sinkcl2), \
    LCL(src2,srccl2), DeviceId(src2), LCL(sink2,sinkcl2), Internet(sink2), \
    FlowComp(s,srccl3,s1,sinkcl3), \
    LCL(src3,srccl3), SimSerial(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    s=s1.


#Bgserv signature------
#/* 
# receiver(r)
# priority(r)>1000
# action(r) = {BOOT_COMPLETED}
# calls(_) = {'<android.content.BroadcastReceiver: void abortBroadcast()>'}
# service(s)
# flows(s) = {$getDeviceId->!File, $File->!WebView, $SDK->!File, $getLine1Number->!File}
# launch(r,s)
# */
Bgserv(r,s) :-     \
    Receiver(r), Service(s), \
    ICCG(r,s), \
    Priority(r,_),  \
    SpecCallerComp(m,_), abortBroadcast(m), \
    CompIntentAction(r,act1), \
    BootCompleted(act1), \
    FlowComp(s,srccl1,s1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), FileSink(sink1), \
    FlowComp(s,srccl2,s1,sinkcl2), \
    LCL(src2,srccl2), FileSrc(src2), LCL(sink2,sinkcl2), WebView(sink2), \
    FlowComp(s,srccl3,s1,sinkcl3), \
    LCL(src3,srccl3), SDK(src3), LCL(sink3,sinkcl3), FileSink(sink3), \
    FlowComp(s,srccl4,s1,sinkcl4), \
    LCL(src4,srccl4), LineNumber(src4), LCL(sink4,sinkcl4), FileSink(sink4), \
    s=s1.

#CoinPirate signature------
#/* 
# receiver(r)
# priority(r)>1000
# action(r) = {SMS_SENT, SMS_RECEIVED}
# calls(r) = {'<android.content.BroadcastReceiver: void abortBroadcast()>'}
# receiver(t)
# service(s)
# calls(s) = {'<android.telephony.SmsManager: void sendTextMessage(java.lang.String,java.lang.String,java.lang.String,android.app.PendingIntent,android.app.PendingIntent)>'}
# flows(s) = {$getDeviceId->!INTERNET, $MODEL->!INTERNET, $SDK->!INTERNET, $getSubscriberId->!INTERNET}
# launch(r,s)
# launch(s,t)
# */
CoinPirate(r,s,t) :- \
    Receiver(r), Receiver(t), Service(s), \
    ICCG(r,s), ICCG(s,t), \
    Priority(r,_),  \
    SpecCallerComp(m,r), abortBroadcast(m), \
    SpecCallerComp(m,s), sendTextMsg(m), \
    CompIntentAction(r,act1), \
    SmsSent(act1), \
    CompIntentAction(r,act2), \
    SmsReceived(act2), \
    FlowComp(s,srccl1,s1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(s,srccl2,s1,sinkcl2), \
    LCL(src2,srccl2), MODEL(src2), LCL(sink2,sinkcl2), Internet(sink2), \
    FlowComp(s,srccl3,s1,sinkcl3), \
    LCL(src3,srccl3), SDK(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    FlowComp(s,srccl4,s1,sinkcl4), \
    LCL(src4,srccl4), SubId(src4), LCL(sink4,sinkcl4), Internet(sink4), \
    s=s1.

#DroidCoupon signature------
#/* 
# receiver(r)
# action(r) = {PACKAGE_ADDED, PACKAGE_REMOVED}
# priority(r) > 1000
# calls(r) = {'<java.lang.Runtime: java.lang.Process exec(java.lang.String)>'}
# receiver(t)
# action(t) = {BOOT_COMPLETED}
# priority(t) > 1000
# service(s)
# calls(s) = {'<java.lang.Runtime: java.lang.Process exec(java.lang.String)>'}
# launch(t,s)
# flows(s) = {$getDeviceId->!INTERNET, $ENC/DEC->!INTERNET, $getSubscriberId->!INTERNET}
# */
DroidCoupon(r,s,t) :-   \
    Receiver(r), Receiver(t), Service(s), \
    ICCG(t,s), \
    Priority(r,_),  \
    Priority(t,_),  \
    SpecCallerComp(m,r), RuntimeExec(m), \
    CompIntentAction(r,act1), PkgRemove(act1), \
    CompIntentAction(r,act2), PkgAdd(act2), \
    CompIntentAction(t,act3), BootCompleted(act3), \
    SpecCallerComp(m,s), RuntimeExec(m), \
    FlowComp(s,srccl1,s1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(s,srccl2,s1,sinkcl2), \
    LCL(src2,srccl2), EncSrc(src2), LCL(sink2,sinkcl2), Internet(sink2), \
    FlowComp(s,srccl3,s1,sinkcl3), \
    LCL(src3,srccl3), SubId(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    s=s1.


#DroidDream signature------
#/* 
# calls(r) = {'<java.lang.Runtime: java.lang.Process exec(java.lang.String)>'}
# flows(r) = {$getDeviceId->!INTERNET, $File->!EXEC, $getSubscriberId->!INTERNET}
# */
DroidDream(r,s) :-        \
    Service(r), Service(s), ICCG(r,s), \
    SpecCallerComp(m,r), RuntimeExec(m), \
    FlowComp(r,srccl1,r1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(r,srccl2,r1,sinkcl2), \
    LCL(src2,srccl2), FileSrc(src2), LCL(sink2,sinkcl2), Exec(sink2), \
    FlowComp(r,srccl3,r1,sinkcl3), \
    LCL(src3,srccl3), SubId(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    r=r1.

#DroidDreamLight signature------
#/* 
# receiver(r)
# service(s)
# launch(r,s)
# action(r) = {PHONE_STATE}
# flows(s) = {$getDeviceId->!INTERNET, $InstalledPackages->!INTERNET, $getSubscriberId->!INTERNET}
# */
DroidDreamLight(r,s) :-        \
    Receiver(r), Service(s), ICCG(r,s), \
    CompIntentAction(r,act), PhoneState(act), \
    FlowComp(s,srccl1,s1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(s,srccl2,s1,sinkcl2), \
    LCL(src2,srccl2), InstallPackage(src2), LCL(sink2,sinkcl2), Internet(sink2), \
    FlowComp(s,srccl3,s1,sinkcl3), \
    LCL(src3,srccl3), SubId(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    s=s1.

#DroidKungFu1 signature------
#/*receiver->service(leak data)->activity
# receiver(r)
# service(s)
# activity(a)
# launch(r,s)
# launch(s,a)
# action(r) = {BOOT_COMPLETED}
# flows(s) = {$getDeviceId->!INTERNET, $MODEL->!INTERNET, $BRAND->!INTERNET, $getLine1Number->!INTERNET}
# !flows(_) = {$ENC/DEC->!INTERNET}
# installAPK(_)
# */
DroidKungFu1(r,s,a) :-     \
    Receiver(r), Service(s), Activity(a), InstallAPK(g), \
    ICCG(r,s), ICCG(s,a), ICCG(_,g), \
    CompIntentAction(r,act), BootCompleted(act), \
    FlowComp(s,srccl1,s1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(s,srccl2,s1,sinkcl2), \
    LCL(src2,srccl2), MODEL(src2), LCL(sink2,sinkcl2), Internet(sink2), \
    FlowComp(s,srccl3,s1,sinkcl3), \
    LCL(src3,srccl3), BRAND(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    FlowComp(s,srccl4,s1,sinkcl4), \
    LCL(src4,srccl4), LineNumber(src4), LCL(sink4,sinkcl4), Internet(sink4), \
    s=s1.

####    !EncToInternet(_,_), \
#FIXME
#EncToInternet(src, sink) :- 
 #   FlowComp(_,srccl,_,sinkcl), \
 #   LCL(src,srccl), EncSrc(src), LCL(sink,sinkcl), Internet(sink), \

#DroidKungFu2 signature------
#/*receiver->service(leak data)->activity
# receiver(r)
# service(s)
# activity(a)
# launch(r,s)
# launch(s,a)
# action(r) = {BOOT_COMPLETED}
# flows(s) = {$getDeviceId->!INTERNET, $MODEL->!INTERNET, $BRAND->!INTERNET, $getLine1Number->!INTERNET, $ENC/DEC->!INTERNET}
# installAPK(_)
# */
DroidKungFu2(r,s,a) :-   \
    Receiver(r), Service(s), Activity(a), \
    ICCG(r,s), ICCG(s,a), \
    ICCG(_,g), InstallAPK(g), \
    CompIntentAction(r,act), BootCompleted(act), \
    FlowComp(s,srccl1,s1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(s,srccl2,s1,sinkcl2), \
    LCL(src2,srccl2), MODEL(src2), LCL(sink2,sinkcl2), Internet(sink2), \
    FlowComp(s,srccl3,s1,sinkcl3), \
    LCL(src3,srccl3), BRAND(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    FlowComp(s,srccl4,s1,sinkcl4), \
    LCL(src4,srccl4), LineNumber(src4), LCL(sink4,sinkcl4), Internet(sink4), \
    FlowComp(s,srccl5,s1,sinkcl5), \
    LCL(src5,srccl5), EncSrc(src5), LCL(sink5,sinkcl5), Internet(sink5), \
    s=s1.

#DroidKungFu3 signature------
#/*receiver->service(leak data)->activity
# receiver(r)
# service(s)
# activity(a)
# launch(r,s)
# launch(s,a)
# action(r) = {BOOT_COMPLETED}
# flows(s) = {$getDeviceId->!INTERNET, $MODEL->!INTERNET, $BRAND->!INTERNET, $getLine1Number->!INTERNET, $ENC/DEC->!INTERNET}
# installAPK(_)
# */
DroidKungFu3(r,s,a) :-                 \
    Receiver(r), Service(s), Activity(a), InstallAPK(g), \
    ICCG(r,s), ICCG(s,a), ICCG(_,g), \
    CompIntentAction(r,act), BootCompleted(act), \
    FlowComp(s,srccl1,s1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(s,srccl2,s1,sinkcl2), \
    LCL(src2,srccl2), MODEL(src2), LCL(sink2,sinkcl2), Internet(sink2), \
    FlowComp(s,srccl3,s1,sinkcl3), \
    LCL(src3,srccl3), BRAND(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    FlowComp(s,srccl4,s1,sinkcl4), \
    LCL(src4,srccl4), LineNumber(src4), LCL(sink4,sinkcl4), Internet(sink4), \
    FlowComp(s,srccl5,s1,sinkcl5), \
    LCL(src5,srccl5), EncSrc(src5), LCL(sink5,sinkcl5), Internet(sink5), \
    s=s1.

#DroidKungFu4 signature------
#Case 1:
#/*receiver->service(leak data)->activity
# receiver(r)
# service(s)
# activity(a)
# launch(r,s)
# launch(s,a)
# action(r) = {BOOT_COMPLETED}
# flows(s) = {$getDeviceId->!FILE, $MODEL->!FILE, $BRAND->!FILE, $ENC/DEC->!EXEC}
# installAPK(_)
# */
DroidKungFu4(r,a) :-         \
    Receiver(r), Activity(a), \
    ICCG(r,s), ICCG(s,a), \
    InstallAPK(g), TgtDataType(g,_), \
    CompIntentAction(r,act), BootCompleted(act), \
    FlowComp(a,srccl1,a1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), FileSink(sink1), \
    FlowComp(a,srccl2,a1,sinkcl2), \
    LCL(src2,srccl2), MODEL(src2), LCL(sink2,sinkcl2), FileSink(sink2), \
    FlowComp(a,srccl3,a1,sinkcl3), \
    LCL(src3,srccl3), BRAND(src3), LCL(sink3,sinkcl3), FileSink(sink3), \
    FlowComp(a,srccl4,a1,sinkcl4), \
    LCL(src4,srccl4), EncSrc(src4), LCL(sink4,sinkcl4), Exec(sink4), \
    a=a1.


#Case 2:
#Activity(a)
# flows(a) = {$getDeviceId->!FILE, $MODEL->!FILE, $BRAND->!FILE, $ENC/DEC->!FILE}
DroidKungFu4(r,a) :-         \
    Receiver(r), Activity(a), \
    FlowComp(a,srccl1,a1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), FileSink(sink1), \
    FlowComp(a,srccl2,a1,sinkcl2), \
    LCL(src2,srccl2), MODEL(src2), LCL(sink2,sinkcl2), FileSink(sink2), \
    FlowComp(a,srccl3,a1,sinkcl3), \
    LCL(src3,srccl3), BRAND(src3), LCL(sink3,sinkcl3), FileSink(sink3), \
    FlowComp(a,srccl4,a1,sinkcl4), \
    LCL(src4,srccl4), EncSrc(src4), LCL(sink4,sinkcl4), FileSink(sink4), \
    a=a1.

#Geinimi signature------
#/* receiver->service(self loop and leak data)
# receiver(r)
# service(s)
# launch(r,s)
# launch(s,s)
# action(r) = {BOOT_COMPLETED}
# flows(s) = {$getDeviceId->!INTERNET, $MODEL->!INTERNET, $BRAND->!INTERNET, $getLine1Number->!INTERNET}
# */
Geinimi(r,s) :-             \
    Receiver(r), Service(s), \
    ICCG(r,s), ICCG(s,s1), \
    CompIntentAction(r,act1), BootCompleted(act1), \
    FlowComp(s,srccl1,s1,sinkcl1),         \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(s,srccl2,s1,sinkcl2), \
    LCL(src2,srccl2), BRAND(src2), Internet(sink2), LCL(sink2,sinkcl2), \
    FlowComp(s,srccl3,s1,sinkcl3), \ 
    LCL(src3,srccl3), MODEL(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    FlowComp(s,srccl4,s1,sinkcl4), \ 
    LCL(src4,srccl4), LineNumber(src4), LCL(sink4,sinkcl4), Internet(sink4), \
    s=s1.

#GingerMaster signature------
# /*
#   receiver(r)
#   service(s)
#   calls(s) = {'<java.lang.Runtime: java.lang.Process exec(java.lang.String)>'}
#   flows(s) = {$getDeviceId->!INTERNET, $getLine1Number->!INTERNET, $getSubscriberId->!INTERNET}
#   {$ENC/DEC -> !INTERNET} is not a subset of flows(_) 
#   launch(r,s)
#  */
GingerMaster(r,s) :-        \
    Receiver(r), Service(s), \
    ICCG(r,s), \
    SpecCallerComp(m,s), RuntimeExec(m), \
    FlowComp(s,srccl1,s1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(s,srccl2,s1,sinkcl2), \
    LCL(src2,srccl2), LineNumber(src2), LCL(sink2,sinkcl2), Internet(sink2), \
    FlowComp(s,srccl3,s1,sinkcl3), \
    LCL(src3,srccl3), SubId(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    s=s1. 

#GOLDDREAM signature------
#/* 
# receiver(r)
# service(s)
# launch(r,s)
# action(r) = {PHONE_STATE, BOOT_COMPLETED, SMS_RECEIVED, NEW_OUTGOING_CALL}
# flows(s) = {$getDeviceId->!INTERNET, $getSimSerialNumber->!INTERNET, $getSubscriberId->!INTERNET}
# */
GoldDream(r,s) :-           \
    Receiver(r), Service(s), \
    ICCG(r,s), \
    CompIntentAction(r,act1), PhoneState(act1), \
    CompIntentAction(r,act2), BootCompleted(act2), \
    CompIntentAction(r,act3), SmsReceived(act3), \
    CompIntentAction(r,act4), NewOutCall(act4), \
    FlowComp(s,srccl1,s1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(s,srccl2,s1,sinkcl2), \
    LCL(src2,srccl2), SimSerial(src2), LCL(sink2,sinkcl2), Internet(sink2), \
    FlowComp(s,srccl3,s1,sinkcl3), \
    LCL(src3,srccl3), SubId(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    s=s1.

#PJAPPS signature------
# /*
# receiver(r)
# action(r) = {SIG_STR}
# service(s)
# calls(_) = {'<android.content.BroadcastReceiver: void abortBroadcast()>'}
# flows(s) = {$getDeviceId->!INTERNET, $getLine1Number->!INTERNET, $getSubscriberId->!INTERNET}
# */
PJapps(r,s) :-            \
    Receiver(r), Service(s), \
    CompIntentAction(r, act1), SigStr(act1), \
    SpecCallerComp(m,_), abortBroadcast(m), \
    FlowComp(s,srccl1,s1,sinkcl1), \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), Internet(sink1), \
    FlowComp(s,srccl2,s1,sinkcl2), \
    LCL(src2,srccl2), LineNumber(src2), LCL(sink2,sinkcl2), Internet(sink2), \
    FlowComp(s,srccl3,s1,sinkcl3), \
    LCL(src3,srccl3), SubId(src3), LCL(sink3,sinkcl3), Internet(sink3), \
    s=s1.


#jSMSHider signature------
#/*
# receiver(r)
# service(s)
# activity(a)
# launch(a,s)
# action(r) = {PACKAGE_REMOVE, PACKAGE_ADDED, PACKAGE_CHANGED, PACKAGE_INSTALL, PACKAGE_REPLACED}
# calls(s) = {'<java.lang.Runtime: java.lang.Process exec(java.lang.String)>'}
# flows(a) = {$getDeviceId->!ENC/DEC, $SDK->!ENC/DEC, $MODEL->!ENC/DEC}
#  */
jSMSHider(r,a,s) :-                    \ 
    Receiver(r), Activity(a), Service(s), \
    ICCG(a,s), \
    CompIntentAction(r,act1), PkgRemove(act1),  \
    CompIntentAction(r,act2), PkgAdd(act2),     \
    CompIntentAction(r,act3), PkgChg(act3),     \
    CompIntentAction(r,act4), PkgInstall(act4), \
    CompIntentAction(r,act5), PkgReplace(act5), \
    SpecCallerComp(m,s), RuntimeExec(m),        \
    FlowComp(a,srccl1,a1,sinkcl1),              \
    LCL(src1,srccl1), DeviceId(src1), LCL(sink1,sinkcl1), EncSink(sink1), \
    FlowComp(a,srccl2,a1,sinkcl2), \
    LCL(src2,srccl2), SDK(src2), EncSink(sink2), LCL(sink2,sinkcl2), \
    FlowComp(a,srccl3,a1,sinkcl3), \ 
    LCL(src3,srccl3), MODEL(src3), LCL(sink3,sinkcl3), EncSink(sink3), \
    a=a1.
